import{r as t,c as s,h as i}from"./p-d4191909.js";import{H as o}from"./p-f0bd18cd.js";import"./p-61a7920a.js";import{V as e}from"./p-0aafcc26.js";import{C as n}from"./p-cbaef6e6.js";import{k as r,l as a,B as l}from"./p-369c1d7e.js";import{e as h}from"./p-554ca4d4.js";import{p as c}from"./p-794858b0.js";import"./p-0c3518a5.js";import{a as d,C as f}from"./p-be2ac731.js";import"./p-ad52b503.js";import{i as m}from"./p-a247a1f7.js";import{C as p}from"./p-c785e2db.js";const u=class{constructor(i){t(this,i),this.getRoutingStateEvent=s(this,"webcardinal:routing:get",7),this.getModelEvent=s(this,"webcardinal:model:get",7),this.getTranslationModelEvent=s(this,"webcardinal:translationModel:get",7),this.controller="",this.disableContainer=!1,this.disableTranslations=!1}async componentWillLoad(){if(!this.host.isConnected)return;const t=r(this);if(t){const t=await a(this);await d.loadAndSetTranslationsForPage(t)}const[s,i]=this.resolveControllerElement();let o,f,m=this.history;if(this.chain=h(this.host),this.chain)try{o=await c(this.getModelEvent),f=await c(this.getTranslationModelEvent),this.controllerInstance=await this.loadController(s,m,o,f)}catch(t){console.error(t)}else this.controllerInstance=await this.loadController(s,m),o=this.controllerInstance.model,f=this.controllerInstance.model;this.host.hasAttribute("default-controller")&&!this.host.hasAttribute(e)||(o||f)&&(l.bindChildNodes(i,{model:o,translationModel:f,recursive:!0,chainPrefix:this.chain?this.chain.slice(1):null,enableTranslations:t}),this.listeners=new n(this.host,{model:o,translationModel:f}),o&&this.listeners.getModel.add(),f&&this.listeners.getTranslationModel.add())}async connectedCallback(){if(this.listeners){const{getModel:t,getTranslationModel:s}=this.listeners;null==t||t.add(),null==s||s.add()}}async disconnectedCallback(){if(this.listeners){const{getModel:t,getTranslationModel:s}=this.listeners;null==t||t.remove(),null==s||s.remove()}setTimeout((()=>{var t;document.body.contains(this.host)||null===(t=this.controllerInstance)||void 0===t||t.disconnectedCallback()}),100)}async componentDidLoad(){this.disableContainer&&(Array.from(this.host.childNodes).forEach((t=>this.host.parentNode.insertBefore(t,this.host))),this.host.remove())}async getModel(){if(this.controllerInstance)return this.controllerInstance.model}async getTranslationModel(){if(this.controllerInstance)return this.controllerInstance.translationModel}resolveControllerElement(){let t=this.host;if(this.host.hasAttribute("bind-modal")){const t=this.host.parentNode;if(t instanceof ShadowRoot)return[t.host,t.host]}if(this.host.hasAttribute("bind-component")){const t=this.host.parentNode;if(t instanceof ShadowRoot)return[t.host,this.host];if(t instanceof HTMLElement)return[t,this.host]}return this.disableContainer?[t.parentElement,t.parentElement]:[t,t]}async loadController(t,s,i,o){const e=()=>(this.host.setAttribute("default-controller",""),new p(t,s,i,o));if(this.host.hasAttribute("controller-name")&&!this.controller&&(console.warn(['Attribute "controller-name" is deprecated!','Use "controller" instead!'].join("\n"),"target:",this.host),this.controller=this.host.getAttribute("controller-name")),"string"!=typeof this.controller)return console.error('"controller" must be a string!'),e();if(0===this.controller.length)return e();try{return new(await f.getController(this.controller))(t,s,i,o)}catch(t){return console.error(`Error while loading controller "${this.controller}"`,t),e()}}render(){return this.disableContainer?null:i("slot",null)}};(function(t,s,i,o){var e,n=arguments.length,r=n<3?s:null===o?o=Object.getOwnPropertyDescriptor(s,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,s,i,o);else for(var a=t.length-1;a>=0;a--)(e=t[a])&&(r=(n<3?e(r):n>3?e(s,i,r):e(s,i))||r);n>3&&r&&Object.defineProperty(s,i,r)})([o()],u.prototype,"host",void 0),m(u);export{u as webc_container}