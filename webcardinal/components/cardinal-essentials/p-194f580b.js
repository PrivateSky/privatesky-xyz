import{g as t}from"./p-8419ec55.js";function n(t,n,e=!1,o=null){const s=new CustomEvent(t,n);e&&(o?o.dispatchEvent(s):document.dispatchEvent(s))}function e(t,n,e){let o=null;for(;t;){if(t.matches(n)){o=t;break}if(e&&t.matches(e))break;t=t.parentElement}return o}function o(t){let n=t.replace(/[^A-Za-z0-9_-]/g,"-").toLowerCase();return n=n.replace(/(-+){2}/gm,"-"),n=n.replace(/(-+)$/gm,""),n}function s(t,n){const e=o(t),s=n.querySelector("#"+e);if(!s)return;s.scrollIntoView();let r=window.location.href,c="?";-1!==r.indexOf("chapter=")?(r=window.location.href.split("chapter=")[0],r.length>0&&(c=r[r.length-1],r=r.substring(0,r.length-1))):c=r.indexOf("?")>0?"&":"?",window.history.pushState({},"",`${r}${c+"chapter="}${e}`)}function r(t){return t&&"string"==typeof t&&0!==t.length?t.split("").map((t=>t===t.toLowerCase()?t:"-"+t.toLowerCase())).join(""):""}function c(t){return t&&"string"==typeof t&&0!==t.length?t.split("-").map(((t,n)=>0===n?t:t.charAt(0).toUpperCase()+t.slice(1))).join(""):""}function i(t){if("string"!=typeof t)throw new Error("Invalid model chain");return t.split("@").join("")}function a(t){if("boolean"==typeof t)return t;if("string"==typeof t)switch(t.toLowerCase().trim()){case"true":case"1":return!0;case"false":case"0":case null:return!1;default:return Boolean(t)}return Boolean(t)}function l(t){return t.replace(/-([a-z])/g,(function(t){return t[1].toUpperCase()}))}function u(n){const e=t(n);if(!e.innerHTML)return null;let o=e.querySelector("style");if(o){let t=e.innerHTML.replace(o.outerHTML,"");return e.innerHTML=o.outerHTML,t}return e.innerHTML}function d(t,n){const e=document.createElement("style");e.innerHTML=n,t.appendChild(e)}function w(t,n=null){let e=window.$$;return e&&e.SSAPP_CONTEXT&&e.SSAPP_CONTEXT.BASE_URL&&e.SSAPP_CONTEXT.SEED&&0!==t.indexOf(e.SSAPP_CONTEXT.BASE_URL)&&0!==t.indexOf("data:image")&&(t=`${e.SSAPP_CONTEXT.BASE_URL}${0===t.indexOf("/")?t.substr(1):t}`),fetch(t,n)}window.cardinal=window.cardinal||{},window.cardinal.oldCustomTheme=window.cardinal.oldCustomTheme||{};const{oldCustomTheme:f}=window.cardinal;f.dependencies=f.dependencies||{},f.imports=f.imports||{},f.appTheme=f.appTheme||null;const{dependencies:m,imports:b}=f,p=/@import.*?["']([^"']+)["'].*?;/g;function h(t){return new Promise(((n,e)=>{w(t).then((t=>{if(t.ok)return n(t.text());e({url:t.url,status:t.status,statusText:t.statusText})}))}))}function g(t,n){return!!n&&(n.shadowRoot?t.parentNode===n.shadowRoot.host:g(n,n.parentElement))}function y(){let n=t=>{let n={};t.addEventListener("styleExists",(e=>{e.stopImmediatePropagation(),e.preventDefault();let o=e.detail.componentTag;(0,e.detail.callback)(void 0,n.hasOwnProperty(o),t),n[o]||(n[o]=!0)})),t.addEventListener("componentWasRemoved",(t=>{let e=t.detail.componentTag;n[e]&&delete n[e]}))};return n(document.querySelector("body")),e=>{const{componentWillLoad:o,disconnectedCallback:s}=e;e.componentWillLoad=function(){const e=t(this);if(e&&e.isConnected){let t=t=>{const{basePath:s}=window.WebCardinal;let r=e.tagName.toLowerCase(),c=n=>new Promise((e=>{let c=s+"/themes/"+t+"/components/"+r+"/"+r+".css";m[c]||(m[c]=new Promise(((t,n)=>{h(c).then((n=>{t(n)})).catch(n)}))),m[c].then((t=>{var e,o;(e=c,o=t,b[e]||(b[e]=new Promise(((t,n)=>{p.exec(o)?o.replace(p,((e,s)=>{m[s]||(m[s]=h(s)),m[s].then((n=>{t(o.replace(e,n))})).catch(n)})):t(o)}))),b[e]).then((t=>{let e=document.createElement("style");e.innerHTML=t,n.append(e)}))})).catch((t=>{console.log(`Request on resource ${t.url} ended with status: ${t.status} (${t.statusText})`)})).finally((()=>{e(o&&o.call(this))}))}));return e.shadowRoot?(n(e),c(e.shadowRoot)):new Promise(e.isConnected?t=>{let n=g(e,e.parentElement);e.isSlotted=n;let s=new CustomEvent("styleExists",{bubbles:!0,cancelable:!0,composed:!0,detail:{callback:(e,s,r)=>{e?console.log(e):s?t(o&&o.call(this)):(n||(r=r.shadowRoot),c(r).then((()=>{t()})))},componentTag:n?"SLOTTED:"+r:r}});e.dispatchEvent(s)}:t=>{t(o&&o.call(this))})};return f.appTheme?t(f.appTheme):new Promise((n=>{let o=new CustomEvent("getThemeConfig",{bubbles:!0,cancelable:!0,composed:!0,detail:(e,o)=>{if(e)return console.log(e);f.appTheme=o,t(f.appTheme).then((()=>{n()}))}});e.dispatchEvent(o)}))}return o&&o.call(this)},e.disconnectedCallback=function(){const n=t(this);let e=n.tagName.toLowerCase();n.isSlotted&&(e="SLOTTED:"+e);let o=new CustomEvent("componentWasRemoved",{bubbles:!0,cancelable:!0,composed:!0,detail:{componentTag:e}});n.dispatchEvent(o),s&&s.call(this)}}}window.cardinal=window.cardinal||{},window.cardinal.customTheme=window.cardinal.customTheme||{THEME:void 0,IMPORTS:{},EVENTS:{GET_THEME:"getThemeConfig",ADD_STYLE:"CustomTheme:add-style",REMOVE_STYLE:"CustomTheme:remove-style"}};const E=window.cardinal.customTheme;async function C(t){const{basePath:n}=window.WebCardinal,e=t.tagName.toLowerCase(),o=t.mode||t.getAttribute("mode")||"default",s=`${n}/themes/${E.THEME}/components/${e}/${e+("default"!==o?"."+o:"")+".css"}`;if(!E.IMPORTS[s]){const[t,n]=await async function(t){try{const n=await w(t);return[!0,await n.text()]}catch(t){return console.log(t),[!1]}}(s);if(!t)return;E.IMPORTS[s]=n}const r=E.IMPORTS[s];t.shadowRoot?(function(t){const n=t.host,e={true:{},false:{}};n.addEventListener(E.EVENTS.ADD_STYLE,(o=>{o.preventDefault(),o.stopImmediatePropagation();const{data:{tag:s,slotted:r},callback:c}=o.detail;e[r][s]||(c(void 0,r?{target:n}:{target:t}),e[r][s]=!0)})),n.addEventListener(E.EVENTS.REMOVE_STYLE,(t=>{t.preventDefault(),t.stopImmediatePropagation();const{data:{tag:n,slotted:o}}=t.detail;e[o][n]=!1}))}(t.shadowRoot),d(t.shadowRoot,r)):(t.isSlotted=function(t){for(;t.parentElement;){if(t.parentElement.shadowRoot)return t.parentElement.shadowRoot.host===t.parentNode;t=t.parentElement}return!1}(t),t.dispatchEvent(new CustomEvent(E.EVENTS.ADD_STYLE,{bubbles:!0,cancelable:!0,composed:!0,detail:{data:{tag:e,slotted:t.isSlotted},callback:async(t,n)=>{if(t)return console.log(t);const{target:e}=n;d(e,r)}}})))}function T(){return n=>{const{componentWillLoad:e,disconnectedCallback:o}=n;n.componentWillLoad=async function(){const n=t(this);return(n||n.isConnected)&&(E.THEME?await C(n):await async function(t,n){t.dispatchEvent(new CustomEvent(E.EVENTS.GET_THEME,{bubbles:!0,cancelable:!0,composed:!0,detail:async(e,o)=>{if(e)return console.log(e);E.THEME=o,await n(t)}}))}(n,C)),e&&e.call(this)},n.disconnectedCallback=async function(){const n=t(this);return n.dispatchEvent(new CustomEvent(E.EVENTS.REMOVE_STYLE,{bubbles:!0,cancelable:!0,composed:!0,detail:{data:{tag:n.tagName.toLowerCase(),slotted:!!n.isSlotted}}})),o&&o.call(this)}}}window.cardinal=window.cardinal||{},window.cardinal.controllers=window.cardinal.controllers||{},window.cardinal.pendingControllerRequests=window.cardinal.pendingControllerRequests||{};const{controllers:$,pendingControllerRequests:v}=window.cardinal,P={registerController:(t,n)=>{if($[t]=n,v[t])for(;v[t].length;)v[t].pop().resolve($[t])},getController:async(t,n=!1)=>{const e=window.WebCardinal;if(e){if(!0===n&&"ContainerController"===t&&(t="WccController"),"object"==typeof e.controllers){const{controllers:n}=e;if(n[t])return n[t]}if("string"==typeof e.basePath){const{basePath:n}=window.WebCardinal;try{let e=await import(`${n}/scripts/controllers/${t}.js`);return e.default||e}catch(t){return console.error(t),null}}}if($[t])return $[t];let o=`scripts/controllers/${t}.js`;if(n&&(o=`cardinal/base/controllers/${t}.js`),void 0!==window.basePath){let t="/"===window.basePath[window.basePath.length-1]?"":"/";o=window.basePath+t+o}try{let t=await import(o);return t.default||t}catch(t){return console.error(t),null}}};export{y as C,T as a,i as b,n as c,l as d,P as e,c as f,u as g,s as h,e as i,o as j,r as n,a as s}