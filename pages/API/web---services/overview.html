<psk-page title="PrivateSky Web Services ">
    <psk-highlight type-of-highlight="note">
        PSK Web Server is a HTTP server that allows the communication between PrivateSky nodes and/or agents inside a node, allows the
        storage and retrieval of bricks (blocks of data stored on the server in files identified by the block's cryptographic hash) and
        allows the grouping of different bricks under the same unique identifier (<code>anchor</code>). Each one of the three components is
        explained in more detail at the links below.
        The PSK Web Server can also be extended to include custom services (besides the default ones below). The section
        <a href="?API/virtualmq/overview&chapter=how-to-extend-a-virtualmq-server"> <code>How to extend a PSK Web Server</code> </a> explains in more
        detail how a PSK Web Server can be extended.
    </psk-highlight>
    <psk-toc title="Table of contents"></psk-toc>
    <psk-chapter title="Default PSK Web Server services">
        <psk-list list-type="unordered">
            <psk-link page="apis/web-services/brick-storage">Brick Storage</psk-link>
            <psk-link page="apis/web-services/anchoring">Anchoring</psk-link>
            <psk-link page="apis/web-services/message-passing">Message Passing</psk-link>
            <psk-link page="apis/web-services/dossier-wizard">Dossier Wizard</psk-link>
        </psk-list>
    </psk-chapter>
    <psk-chapter title="How to create a PSK Web Server">
        <psk-card title="createVirtualMQ">
            The <code>createVirtualMQ()</code> method creates and starts a VirtualMQ server.
            <psk-card title="Syntax">
                <psk-code language="JavaScript">
                    createVirtualMQ(port, rootFolder, sslConfig, callback)
                </psk-code>
                <psk-list list-type="unordered">
                    <psk-card title="Parameters">
                        <psk-list list-type="unordered">
                            <code><b>port</b></code>
                                The port on on which the server is listening for requests.<br><br>
                            <code><b>rootFolder</b></code>
                                The folder where the server keeps the files uploaded on it.<br><br>
                            <code><b>sslConfig</b></code> <b>|</b>Optional
                                An object that configures, among others, the communication protocol used to communicate with
                                clients.
                                By default, "http" is used.<br><br>
                            <code><b>callback</b></code>
                                The function called when the server is started.<br><br>
                        </psk-list>
                    </psk-card>
                    <psk-card title="Return value">
                        The server instance.
                    </psk-card>
                </psk-list>
            </psk-card>

            <psk-card title="Description">
                The <code>createVirtualMQ()</code> method starts a PSK Web Server and returns its instance.
            </psk-card>

            <psk-card title="Examples">
                In the following example, a server that listens on port 8080 and saves files in folder "/foo/tmp"
                is created.
                <psk-code language="JavaScript">
                    const VirtualMQ = require("virtualmq");
                    const port = 8080;
                    const server VirtualMQ.createVirtualMQ(port, "/foo/tmp", undefined, (err) => {
                        if (err) {
                            throw err;
                        }

                        console.log("The server was started and is listening on port", port);
                    });
                </psk-code>

            </psk-card>
        </psk-card>
    </psk-chapter>

    <psk-chapter title="How to extend a PSK Web Server">
        The <code>createVirtualMQ()</code> method starts a HTTP server and return the server instance. As a result, the
        server can be dynamically
        extended using the API below.
        <psk-card title="server.use()">
            <psk-card title="Syntax">
                <psk-code language="JavaScript">
                    server.use(url, handler);
                </psk-code>
                <psk-card title="Parameters">
                    <psk-list list-type="unordered">
                        <code><b>url</b></code>
                            The url where the server listens for requests.
                        <code><b>handler</b></code>
                            The function called for filtering requests that arrive at the server on the specified <code>url</code>.
                    </psk-list>
                </psk-card>
            </psk-card>
        </psk-card>
        <psk-card title="server.put()">
            <psk-card title="Syntax">
                <psk-code language="JavaScript">
                    server.put(url, handler);
                </psk-code>
                <psk-card title="Parameters">
                    <psk-list list-type="unordered">
                        <code><b>url</b></code>
                            The url where the server listens for <code>PUT</code> requests.
                        <code><b>handler</b></code>
                            The function called when the server receives a <code>PUT</code> request at the specified url.
                    </psk-list>
                </psk-card>
            </psk-card>
        </psk-card>
        <psk-card title="server.post()">
            <psk-card title="Syntax">
                <psk-code language="JavaScript">
                    server.post(url, handler);
                </psk-code>
                <psk-card title="Parameters">
                    <psk-list list-type="unordered">
                        <code><b>url</b></code>
                            The url where the server listens for <code>POST</code> requests.
                        <code><b>handler</b></code>
                            The function called when the server receives a <code>POST</code> request at the specified url.
                    </psk-list>
                </psk-card>
            </psk-card>
        </psk-card>
        <psk-card title="server.get()">
            <psk-card title="Syntax">
                <psk-code language="JavaScript">
                    server.get(url, handler);
                </psk-code>
                <psk-card title="Parameters">
                    <psk-list list-type="unordered">
                        <code><b>url</b></code>
                            The url where the server listens for <code>GET</code> requests.
                        <code><b>handler</b></code>
                            The function called when the server receives a <code>GET</code> request at the specified url.
                    </psk-list>
                </psk-card>
            </psk-card>
        </psk-card>
    </psk-chapter>
</psk-page>