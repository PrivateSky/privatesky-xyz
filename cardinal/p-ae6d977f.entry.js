import{r as t,c as e,h as s,g as i}from"./p-1c0c10bb.js";import"./p-67893e64.js";import{a as o}from"./p-ba942fe7.js";import{T as r}from"./p-24eba9a2.js";const n=class{constructor(s){t(this,s),this.modelChanged=!1,this.chain="",this.ignoredNodeNames=["link","style","slot","#text","#comment","text","comment"],this.templateNodes=[],this.dataViewModel=null,this.getModelEvent=e(this,"getModelEvent",7)}prepareTemplate(){let t=Array.from(this.__host.childNodes).filter(t=>-1===this.ignoredNodeNames.indexOf(t.nodeName.toLowerCase())),e=t.filter(t=>!t.hasAttribute("slot")),s=t.find(t=>t.hasAttribute("slot")&&"no-data"===t.getAttribute("slot"));s&&(s.removeAttribute("slot"),this.emptyNode=s.cloneNode(!0)),this.__host.innerHTML="",e?e.forEach(t=>{this.templateNodes.push(t.cloneNode(!0))}):console.error("No template found!")}componentWillLoad(){if(this.__host.isConnected)return this.chain=this.dataViewModel,this.chain=o(this.chain),this.prepareTemplate(),new Promise(t=>{this.getModelEvent.emit({callback:(e,s)=>{e&&console.log(e),this.model=s,t()}})})}componentDidLoad(){this.model&&this.model.onChange(this.chain,()=>{this.modelChanged=!this.modelChanged})}render(){if(!this.__host.isConnected)return null;if(!this.templateNodes)return null;let t=this.model.getChainValue(this.chain);t||(t=[]);let e=[];for(let i=0;i<t.length;i++){let t=this.chain?`${this.chain}.${i}.`:i+".";this.templateNodes.forEach(i=>{let o=i.cloneNode(!0);this.__processNode(o,t);let r=o.tagName.toLowerCase(),n={};o.getAttributeNames().forEach(t=>{n[t]=o.getAttribute(t)});let h=s(r,Object.assign({innerHTML:o.innerHTML},n));e.push(h)})}return 0===e.length&&this.emptyNode?s("div",{innerHTML:this.emptyNode.outerHTML}):e}__processNode(t,e){Array.from(t.attributes).filter(t=>"view-model"===t.name).forEach(s=>{t.setAttribute(s.name,e?`${e}${s.value}`:s.value)}),Array.from(t.attributes).filter(t=>t.value.startsWith("@")).forEach(s=>{const i=s.value.split("@")[1];t.setAttribute(s.name,"@"+(e?`${e}${i}`:i))}),"psk-for-each"!==t.tagName.toLowerCase()&&Array.from(t.children).forEach(t=>{this.__processNode.call(this,t,e)})}get __host(){return i(this)}};!function(t,e,s,i){var o,r=arguments.length,n=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,s):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(t,e,s,i);else for(var h=t.length-1;h>=0;h--)(o=t[h])&&(n=(r<3?o(n):r>3?o(e,s,n):o(e,s))||n);r>3&&n&&Object.defineProperty(e,s,n)}([r({description:["This property is the name of the model which will be used to generate the form. The model should be a JavaScript array.",'All the information about how to write a model, hot to use the two-way binding and how to use the model with this component cand be found in the documentation found at: <psk-link page="forms/using-forms">Using forms</psk-link>'],isMandatory:!0,propertyType:"string",specialNote:["If this property is not provided, nothing written inside the component's template will be displayed."]})],n.prototype,"dataViewModel",void 0);export{n as psk_for_each}