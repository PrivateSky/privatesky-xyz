System.register(["./p-7a13ecf1.system.js","./p-90e1ba03.system.js","./p-ca300ef6.system.js","./p-9221707b.system.js","./p-3f952558.system.js","./p-839127aa.system.js"],(function(e){"use strict";var t,n,r,o,i,a;return{setters:[function(e){t=e.r;n=e.h;r=e.g},function(){},function(){},function(e){o=e.T},function(e){i=e.C},function(e){a=e.B}],execute:function(){var s=undefined&&undefined.__decorate||function(e,t,n,r){var o=arguments.length,i=o<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r,a;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")i=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)if(a=e[s])i=(o<3?a(i):o>3?a(t,n,i):a(t,n))||i;return o>3&&i&&Object.defineProperty(t,n,i),i};var p="/apps";var d=e("psk_ssapp",function(){function e(e){t(this,e)}e.prototype.hasRelevantMatchParams=function(){return this.match&&this.match.params&&this.match.params.appName};e.prototype.loadApp=function(e){var t=this;if(this.hasRelevantMatchParams()){this.applicationName=this.match.params.appName}else{this.applicationName=this.appName}this.getAppSeed((function(n,r){if(n){throw n}t.seed=r;t.digestSeedHex=t.digestMessage(r);if(typeof e==="function"){e()}}))};e.prototype.componentShouldUpdate=function(e,t,n){if(e!==t&&n==="digestSeedHex"){window.document.removeEventListener(t,this.eventHandler);window.document.addEventListener(e,this.eventHandler);return true}return false};e.prototype.ssappEventHandler=function(e){var t=e.detail||{};var n=this.element.querySelector("iframe");if(t.query==="seed"){n.contentWindow.document.dispatchEvent(new CustomEvent(this.digestSeedHex,{detail:{seed:this.seed}}));return}if(t.status==="completed"){n.contentWindow.location.reload()}};e.prototype.componentDidLoad=function(){this.eventHandler=this.ssappEventHandler.bind(this);window.document.addEventListener(this.digestSeedHex,this.eventHandler)};e.prototype.getSWOnMessageHandler=function(){var e=this;if(this.onServiceWorkerMessageHandler){return this.onServiceWorkerMessageHandler}this.onServiceWorkerMessageHandler=function(t){if(!t.data||t.data.query!=="seed"){return}var n=t.data.identity;if(n===e.digestSeedHex){t.source.postMessage({seed:e.seed})}};return this.onServiceWorkerMessageHandler};e.prototype.connectedCallback=function(){navigator.serviceWorker.addEventListener("message",this.getSWOnMessageHandler())};e.prototype.disconnectedCallback=function(){navigator.serviceWorker.removeEventListener("message",this.getSWOnMessageHandler())};e.prototype.getManifest=function(e){fetch("/download/manifest").then((function(t){t.text().then((function(t){e(undefined,JSON.parse(t))})).catch((function(t){e(t)}))}))};e.prototype.getAppSeed=function(e){var t=this;this.getManifest((function(n,r){if(n){throw n}if(r.mounts){for(var o in r.mounts){if(o===p+"/"+t.applicationName){return e(undefined,r.mounts[o])}}}e(new Error("No seed for app "+t.applicationName))}))};e.prototype.componentWillLoad=function(){var e=this;return new Promise((function(t){e.loadApp(t)}))};e.prototype.digestMessage=function(e){var t=require("pskcrypto");var n=t.pskHash(e,"hex");return n};e.prototype.render=function(){var e=window.top.location.href;if(e[e.length-1]!=="/"){e+="/"}var t=e+"iframe/"+this.digestSeedHex;return n("iframe",{sandbox:"allow-scripts allow-same-origin allow-forms","landing-page":this.landingPath,frameborder:"0",style:{overflow:"hidden",height:"100%",width:"100%"},src:t})};Object.defineProperty(e.prototype,"element",{get:function(){return r(this)},enumerable:true,configurable:true});Object.defineProperty(e,"watchers",{get:function(){return{appName:["loadApp"],match:["loadApp"]}},enumerable:true,configurable:true});return e}());s([a()],d.prototype,"modelHandler",void 0);s([i(),o({isMandatory:true,description:["This property represents the name of the Self Sovereign Application that you want to run."],propertyType:"string"})],d.prototype,"appName",void 0);s([o({isMandatory:true,description:"This property represents the direct path that will be passed to the Iframe as the landing-page property.",propertyType:"string"})],d.prototype,"landingPath",void 0)}}}));