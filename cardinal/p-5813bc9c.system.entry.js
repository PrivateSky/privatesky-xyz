System.register(["./p-c99df712.system.js","./p-90e1ba03.system.js","./p-ca300ef6.system.js","./p-fad6c953.system.js"],(function(e){"use strict";var t,n,r,o;return{setters:[function(e){t=e.r;n=e.h;r=e.g},function(){},function(){},function(e){o=e.T}],execute:function(){var i=undefined&&undefined.__decorate||function(e,t,n,r){var o=arguments.length,i=o<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r,s;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")i=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)if(s=e[a])i=(o<3?s(i):o>3?s(t,n,i):s(t,n))||i;return o>3&&i&&Object.defineProperty(t,n,i),i};var s="/apps";var a=e("psk_ssapp",function(){function e(e){t(this,e);if(this.match&&this.match.params&&this.match.params.appName){this.appName=this.match.params.appName}}e.prototype.componentDidLoad=function(){var e=this;var t=this.element.querySelector("iframe");window.document.addEventListener(this.digestSeedHex,(function(n){var r=n.detail||{};if(r.query==="seed"){t.contentWindow.document.dispatchEvent(new CustomEvent(e.digestSeedHex,{detail:{seed:e.seed}}));return}if(r.status==="completed"){t.contentWindow.location.reload()}}),true)};e.prototype.getSWOnMessageHandler=function(){var e=this;if(this.onServiceWorkerMessageHandler){return this.onServiceWorkerMessageHandler}this.onServiceWorkerMessageHandler=function(t){if(!t.data||t.data.query!=="seed"){return}var n=t.data.identity;if(n===e.digestSeedHex){t.source.postMessage({seed:e.seed})}};return this.onServiceWorkerMessageHandler};e.prototype.connectedCallback=function(){navigator.serviceWorker.addEventListener("message",this.getSWOnMessageHandler())};e.prototype.disconnectedCallback=function(){navigator.serviceWorker.removeEventListener("message",this.getSWOnMessageHandler())};e.prototype.getManifest=function(e){fetch("/download/manifest").then((function(t){t.text().then((function(t){e(undefined,JSON.parse(t))})).catch((function(t){e(t)}))}))};e.prototype.getAppSeed=function(e){var t=this;this.getManifest((function(n,r){if(n){throw n}if(r.mounts){for(var o in r.mounts){if(o===s+"/"+t.appName){return e(undefined,r.mounts[o])}}}e(new Error("No seed for app "+t.appName))}))};e.prototype.componentWillLoad=function(){var e=this;return new Promise((function(t){e.getAppSeed((function(n,r){if(n){throw n}e.seed=r;e.digestSeedHex=e.digestMessage(r);t()}))}))};e.prototype.digestMessage=function(e){var t=require("pskcrypto");var n=t.pskHash(e,"hex");return n};e.prototype.render=function(){var e=window.top.location.href;if(e[e.length-1]!=="/"){e+="/"}var t=e+"iframe/"+this.digestSeedHex;return n("iframe",{sandbox:"allow-scripts allow-same-origin allow-forms","landing-page":this.landingPath,frameborder:"0",style:{overflow:"hidden",height:"100%",width:"100%"},src:t})};Object.defineProperty(e.prototype,"element",{get:function(){return r(this)},enumerable:true,configurable:true});return e}());i([o({isMandatory:true,description:["This property represents the name of the Self Sovereign Application that you want to run."],propertyType:"string"})],a.prototype,"appName",void 0);i([o({isMandatory:true,description:"This property represents the direct path that will be passed to the Iframe as the landing-page property.",propertyType:"string"})],a.prototype,"landingPath",void 0)}}}));